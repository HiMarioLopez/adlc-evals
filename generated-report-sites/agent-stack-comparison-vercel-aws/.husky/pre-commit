#!/bin/sh
# Exit on any error
set -e

# Project directory where ultracite config lives
PROJECT_DIR="$(dirname "$0")/.."

# Check if there are any staged files
if [ -z "$(git diff --cached --name-only)" ]; then
  echo "No staged files to format"
  exit 0
fi

# Run formatter/linter (from project directory where config lives)
cd "$PROJECT_DIR"
bun x ultracite fix

# Check if formatter modified any staged files
MODIFIED=$(git diff --name-only)
if [ -n "$MODIFIED" ]; then
  echo ""
  echo "⚠️  Ultracite modified files. Please review and re-stage:"
  echo "$MODIFIED"
  echo ""
  echo "Run: git add -u && git commit"
  exit 1
fi

exit 0
